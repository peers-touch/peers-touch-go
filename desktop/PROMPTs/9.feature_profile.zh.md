# 个人页与用户设置（Profile）设计规范

面向 Peers-Touch 联邦网络的 Actor（用户）身份，强调最小化披露、强隐私与可携带性。本规范用于指导个人页展示与用户设置实现，所有实现需遵循项目的 UIKit/ThemeTokens 设计与目录结构规范。

## 目标
- 最小必要信息公开，字段级可见性控制。
- 统一视觉与交互：使用 `UIKit` 间距、圆角、分隔线与 `WeChatTokens/LobeTokens` 颜色。
- 支持联邦迁移、密钥与设备管理、数据导出导入。

## 信息架构
- 顶部个人卡片：头像、显示名、`@handle`、ActorID、简介摘要、地区/时区标签、认证徽标（自我/同伴/服务器）。
- 分区页签（或区块）：资料、动态/Moments 预览、关系（关注/粉丝）、隐私与安全、联邦与迁移、数据与备份。
- 快捷操作：消息、关注/取消关注、分享名片、屏蔽/静音、举报（仅本端服务器）。

## 字段设计（UserDetail 模型）
- 基础：`id`、`displayName`、`handle`、`summary`、`avatarUrl`、`coverUrl`、`region`、`timezone`、`tags`、`links[]`。
- 身份：`actorUrl`、`serverDomain`、`keyFingerprint`、`verifications[]`（自我签名/同伴背书/服务器签章）。
- 统计：`followersCount`、`followingCount`、`showCounts`（是否显示具体数字）。
- 动态：`moments[]`（最近媒体缩略图）。
- 隐私设置：
  - `defaultVisibility`：公开/未列出/粉丝可见/私密。
  - `manuallyApprovesFollowers`：是否手动批准关注。
  - `messagePermission`：所有人/互相关注/关闭。
  - `autoExpireDays`：默认过期天数（可选：7/30/90）。

## 交互与动线
- 个人卡片右下角主按钮：
  - “Messages”：打开私信（遵循 `messagePermission`）。
  - “关注/取消关注”：状态式按钮；旁边更多菜单（屏蔽、静音、举报、分享名片）。
- 分区编辑为表单，保存前展示可见性预览；重要操作二次确认（导出、轮换、迁移）。

## 视觉规范（必须）
- 间距：`UIKit.spaceXs/Sm/Md/Lg/Xl`。
- 圆角：`UIKit.radiusSm/Md/Lg`。
- 分隔线：`Divider(thickness: UIKit.dividerThickness, color: UIKit.dividerColor(context))`。
- 文本：
  - 主文案：`Theme.of(context).textTheme.titleMedium/titleLarge`，颜色 `UIKit.textPrimary(context)`。
  - 辅助文案：`Theme.of(context).textTheme.bodySmall/bodyMedium`，颜色 `UIKit.textSecondary(context)`。
- 背景：优先使用 `WeChatTokens.bgLevel{1,2,3}`，回退到 `LobeTokens` 或 `colorScheme.surface/surfaceVariant/background`。

## 目录结构与命名
- `lib/features/profile/`
  - `controller/profile_controller.dart`
  - `view/profile_page.dart`
  - `model/user_detail.dart`
  - `profile_binding.dart`
- 组件命名：`ProfileCard`、`ProfilePrivacySection`、`ProfileMoments` 等（后续可拆分到 `features/shared/components`）。

## MVP 实施范围
- 展示：头像、昵称、handle、简介、地区/时区、Moments 预览、消息/关注按钮。
- 设置：默认可见范围、关注批准、私信权限的基础表单与开关（本地状态）。
- 路由与绑定：通过现有 `AppPages` 注册的 `/profile` 路由与 `ProfileBinding`。

## 验收要点
- 所有边距/圆角/分隔线/颜色通过 UIKit/ThemeTokens，禁止硬编码。
- 表单与按钮交互可运行，预览无错误。
- 代码风格遵循 `PROJECT_BASE_PROMPT.zh.md` 与 `PROMPTs/4.global_ui_kit_and_theme.zh.md`、`PROMPTs/6.global_ui_visual.zh.md`。

---
后续增强（非 MVP）：同伴背书/社交恢复、密钥轮换计划、迁移助手、Relay/缓存策略、细粒度过滤与自动过期、外部身份绑定（PGP/DID/ENS）。